<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: RSpec::Mocks::MessageExpectation
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="/stylesheets/docs/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="/stylesheets/docs/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!RSpec/Mocks/MessageExpectation.html";
</script>


  <script type="text/javascript" charset="utf-8" src="/javascripts/docs/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="/javascripts/docs/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../RSpec.html" title="RSpec (module)">RSpec</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Mocks.html" title="RSpec::Mocks (module)">Mocks</a></span></span>
     &raquo; 
    <span class="title">MessageExpectation</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: RSpec::Mocks::MessageExpectation
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">RSpec::Mocks::MessageExpectation</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/rspec/mocks/message_expectation.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Represents an individual method stub or message expectation. The methods
defined here can be used to configure how it behaves. The methods return
<code>self</code> so that they can be chained together to form a fluent
interface.</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="VerifyingMessageExpectation.html" title="RSpec::Mocks::VerifyingMessageExpectation (class)">VerifyingMessageExpectation</a></span></p>
</div>







  
    <h2>
      Configuring Responses
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#and_call_original-instance_method" title="#and_call_original (instance method)">- (nil) <strong>and_call_original</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tells the object to delegate to the original unmodified method when it
receives the message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#and_raise-instance_method" title="#and_raise (instance method)">- (nil) <strong>and_raise</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tells the object to raise an exception when the message is received.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#and_return-instance_method" title="#and_return (instance method)">- (nil) <strong>and_return</strong>(first_value, *values) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tells the object to return a value when it receives the message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#and_throw-instance_method" title="#and_throw (instance method)">- (nil) <strong>and_throw</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tells the object to throw a symbol (with the object if that form is used)
when the message is received.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#and_wrap_original-instance_method" title="#and_wrap_original (instance method)">- (nil) <strong>and_wrap_original</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Decorates the stubbed method with the supplied block.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#and_yield-instance_method" title="#and_yield (instance method)">- (MessageExpectation) <strong>and_yield</strong>(*args) {|@eval_context = Object.new| ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tells the object to yield one or more args to a block when the message is
received.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Constraining Receive Counts
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#at_least-instance_method" title="#at_least (instance method)">- (MessageExpectation) <strong>at_least</strong>(n, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Constrain a message expectation to be received at least a specific number
of times.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#at_most-instance_method" title="#at_most (instance method)">- (MessageExpectation) <strong>at_most</strong>(n, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Constrain a message expectation to be received at most a specific number of
times.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exactly-instance_method" title="#exactly (instance method)">- (MessageExpectation) <strong>exactly</strong>(n, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Constrain a message expectation to be received a specific number of times.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#never-instance_method" title="#never (instance method)">- (MessageExpectation) <strong>never</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Expect a message not to be received at all.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#once-instance_method" title="#once (instance method)">- (MessageExpectation) <strong>once</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Expect a message to be received exactly one time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#thrice-instance_method" title="#thrice (instance method)">- (MessageExpectation) <strong>thrice</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Expect a message to be received exactly three times.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#times-instance_method" title="#times (instance method)">- (MessageExpectation) <strong>times</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Syntactic sugar for <code>exactly</code>, <code>at_least</code> and
<code>at_most</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#twice-instance_method" title="#twice (instance method)">- (MessageExpectation) <strong>twice</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Expect a message to be received exactly two times.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Other Constraints
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ordered-instance_method" title="#ordered (instance method)">- (MessageExpectation) <strong>ordered</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Expect messages to be received in a specific order.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with-instance_method" title="#with (instance method)">- (MessageExpectation) <strong>with</strong>(*args, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Constrains a stub or message expectation to invocations with specific
arguments.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="and_call_original-instance_method">
  
    - (<tt>nil</tt>) <strong>and_call_original</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This is only available on partial doubles.</p>
</div>
  </div>


<p>Tells the object to delegate to the original unmodified method when it
receives the message.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_counter'>counter</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:increment</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_call_original'>and_call_original</span>
<span class='id identifier rubyid_original_count'>original_count</span> <span class='op'>=</span> <span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
<span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span>
<span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span><span class='lparen'>(</span><span class='id identifier rubyid_original_count'>original_count</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>No further chaining is supported after this.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99
100
101</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 97</span>

<span class='kw'>def</span> <span class='id identifier rubyid_and_call_original'>and_call_original</span>
  <span class='id identifier rubyid_and_wrap_original'>and_wrap_original</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_original'>original</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='op'>|</span>
    <span class='id identifier rubyid_original'>original</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="and_raise-instance_method">
  
    
      <span class="overload">- (<tt>nil</tt>) <strong>and_raise</strong> </span>
    
      <span class="overload">- (<tt>nil</tt>) <strong>and_raise</strong>(ExceptionClass) </span>
    
      <span class="overload">- (<tt>nil</tt>) <strong>and_raise</strong>(ExceptionClass, message) </span>
    
      <span class="overload">- (<tt>nil</tt>) <strong>and_raise</strong>(exception_instance) </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>When you pass an exception class, the MessageExpectation will raise an
instance of it, creating it with <code>exception</code> and passing
<code>message</code> if specified. If the exception class initializer
requires more than one parameters, you must pass in an instance and not the
class, otherwise this method will raise an ArgumentError exception.</p>
</div>
  </div>


<p>Tells the object to raise an exception when the message is received.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_raise'>and_raise</span>
<span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_raise'>and_raise</span><span class='lparen'>(</span><span class='const'>OutOfGas</span><span class='rparen'>)</span>
<span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_raise'>and_raise</span><span class='lparen'>(</span><span class='const'>OutOfGas</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>At least 2 oz of gas needed to drive</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_raise'>and_raise</span><span class='lparen'>(</span><span class='const'>OutOfGas</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='symbol'>:oz</span><span class='rparen'>)</span><span class='rparen'>)</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>No further chaining is supported after this.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 147</span>

<span class='kw'>def</span> <span class='id identifier rubyid_and_raise'>and_raise</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_terminal_implementation_action'>terminal_implementation_action</span> <span class='op'>=</span> <span class='const'>Proc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="and_return-instance_method">
  
    
      <span class="overload">- (<tt>nil</tt>) <strong>and_return</strong>(value) </span>
    
      <span class="overload">- (<tt>nil</tt>) <strong>and_return</strong>(first_value, second_value) </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tells the object to return a value when it receives the message. Given more
than one value, the first value is returned the first time the message is
received, the second value is returned the next time, etc, etc.</p>

<p>If the message is received more times than there are values, the last value
is received for every subsequent call.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_counter'>counter</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:count</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_return'>and_return</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 1
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 1
</span>
<span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_counter'>counter</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:count</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_return'>and_return</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='rparen'>)</span>
<span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 1
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 2
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 3
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 3
</span><span class='id identifier rubyid_counter'>counter</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 3
</span><span class='comment'># etc</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>No further chaining is supported after this.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 69</span>

<span class='kw'>def</span> <span class='id identifier rubyid_and_return'>and_return</span><span class='lparen'>(</span><span class='id identifier rubyid_first_value'>first_value</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_values'>values</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_negative?'>negative?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`and_return` is not supported with negative message expectations</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Implementation blocks aren&#39;t supported with `and_return`</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span><span class='lparen'>(</span><span class='id identifier rubyid_first_value'>first_value</span><span class='rparen'>)</span>
  <span class='ivar'>@expected_received_count</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@expected_received_count</span><span class='comma'>,</span> <span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ignoring_args?'>ignoring_args?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='ivar'>@expected_received_count</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@at_least</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_terminal_implementation_action'>terminal_implementation_action</span> <span class='op'>=</span> <span class='const'>AndReturnImplementation</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_values'>values</span><span class='rparen'>)</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="and_throw-instance_method">
  
    
      <span class="overload">- (<tt>nil</tt>) <strong>and_throw</strong>(symbol) </span>
    
      <span class="overload">- (<tt>nil</tt>) <strong>and_throw</strong>(symbol, object) </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tells the object to throw a symbol (with the object if that form is used)
when the message is received.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_throw'>and_throw</span><span class='lparen'>(</span><span class='symbol'>:out_of_gas</span><span class='rparen'>)</span>
<span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_throw'>and_throw</span><span class='lparen'>(</span><span class='symbol'>:out_of_gas</span><span class='comma'>,</span> <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='float'>0.1</span><span class='rparen'>)</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>No further chaining is supported after this.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_and_throw'>and_throw</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_terminal_implementation_action'>terminal_implementation_action</span> <span class='op'>=</span> <span class='const'>Proc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_throw'>throw</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="and_wrap_original-instance_method">
  
    - (<tt>nil</tt>) <strong>and_wrap_original</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This is only available on partial doubles.</p>
</div>
  </div>


<p>Decorates the stubbed method with the supplied block. The original
unmodified method is passed to the block along with any method call
arguments so you can delegate to it, whilst still being able to change what
args are passed to it and/or change the return value.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:large_list</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_wrap_original'>and_wrap_original</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_original_method'>original_method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='op'>|</span>
  <span class='id identifier rubyid_original_method'>original_method</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>No further chaining is supported after this.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117
118
119
120
121
122
123
124
125</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 115</span>

<span class='kw'>def</span> <span class='id identifier rubyid_and_wrap_original'>and_wrap_original</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'>RSpec</span><span class='op'>::</span><span class='const'>Mocks</span><span class='op'>::</span><span class='const'>TestDouble</span> <span class='op'>===</span> <span class='ivar'>@method_double</span><span class='period'>.</span><span class='id identifier rubyid_object'>object</span>
    <span class='ivar'>@error_generator</span><span class='period'>.</span><span class='id identifier rubyid_raise_only_valid_on_a_partial_double'>raise_only_valid_on_a_partial_double</span><span class='lparen'>(</span><span class='symbol'>:and_call_original</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_warn_about_stub_override'>warn_about_stub_override</span> <span class='kw'>if</span> <span class='id identifier rubyid_implementation'>implementation</span><span class='period'>.</span><span class='id identifier rubyid_inner_action'>inner_action</span>
    <span class='ivar'>@implementation</span> <span class='op'>=</span> <span class='const'>AndWrapOriginalImplementation</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='ivar'>@method_double</span><span class='period'>.</span><span class='id identifier rubyid_original_implementation_callable'>original_implementation_callable</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='ivar'>@yield_receiver_to_implementation_block</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="and_yield-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>and_yield</strong>(*args) {|@eval_context = Object.new| ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tells the object to yield one or more args to a block when the message is
received.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_stream'>stream</span><span class='period'>.</span><span class='id identifier rubyid_stub'>stub</span><span class='lparen'>(</span><span class='symbol'>:open</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_and_yield'>and_yield</span><span class='lparen'>(</span><span class='const'>StringIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span></code></pre>
    
  </div>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>@eval_context = Object.new</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


175
176
177
178
179
180
181
182
183
184
185
186</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 175</span>

<span class='kw'>def</span> <span class='id identifier rubyid_and_yield'>and_yield</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>yield</span> <span class='ivar'>@eval_context</span> <span class='op'>=</span> <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>

  <span class='comment'># Initialize args to yield now that it&#39;s being used, see also: comment
</span>  <span class='comment'># in constructor.
</span>  <span class='ivar'>@args_to_yield</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='ivar'>@args_to_yield</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_initial_implementation_action'>initial_implementation_action</span> <span class='op'>=</span> <span class='const'>AndYieldImplementation</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='ivar'>@args_to_yield</span><span class='comma'>,</span> <span class='ivar'>@eval_context</span><span class='comma'>,</span> <span class='ivar'>@error_generator</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="at_least-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>at_least</strong>(n, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Constrain a message expectation to be received at least a specific number
of times.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_least'>at_least</span><span class='lparen'>(</span><span class='int'>9</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


210
211
212
213
214
215
216
217
218
219
220
221</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 210</span>

<span class='kw'>def</span> <span class='id identifier rubyid_at_least'>at_least</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:at_least</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>at_least(0) has been removed, use allow(...).to receive(:message) instead</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>

  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="at_most-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>at_most</strong>(n, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Constrain a message expectation to be received at most a specific number of
times.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_most'>at_most</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


229
230
231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 229</span>

<span class='kw'>def</span> <span class='id identifier rubyid_at_most'>at_most</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:at_most</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exactly-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>exactly</strong>(n, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Constrain a message expectation to be received a specific number of times.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_exactly'>exactly</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199
200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 197</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exactly'>exactly</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:exactly</span><span class='comma'>,</span> <span class='id identifier rubyid_n'>n</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="never-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>never</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Expect a message not to be received at all.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:stop</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_never'>never</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


253
254
255
256
257</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 253</span>

<span class='kw'>def</span> <span class='id identifier rubyid_never'>never</span>
  <span class='id identifier rubyid_error_generator'>error_generator</span><span class='period'>.</span><span class='id identifier rubyid_raise_double_negation_error'>raise_double_negation_error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expect(obj)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_negative?'>negative?</span>
  <span class='ivar'>@expected_received_count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="once-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>once</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Expect a message to be received exactly one time.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_once'>once</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


264
265
266
267
268</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 264</span>

<span class='kw'>def</span> <span class='id identifier rubyid_once'>once</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:exactly</span><span class='comma'>,</span> <span class='int'>1</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ordered-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>ordered</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Expect messages to be received in a specific order.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:prepare</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ordered'>ordered</span>
<span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:run</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ordered'>ordered</span>
<span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_api'>api</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:finish</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ordered'>ordered</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


338
339
340
341
342
343
344
345</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 338</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ordered'>ordered</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_additional_expected_calls'>additional_expected_calls</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
    <span class='ivar'>@order_group</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@ordered</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="thrice-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>thrice</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Expect a message to be received exactly three times.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_thrice'>thrice</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


286
287
288
289
290</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 286</span>

<span class='kw'>def</span> <span class='id identifier rubyid_thrice'>thrice</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:exactly</span><span class='comma'>,</span> <span class='int'>3</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="times-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>times</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Syntactic sugar for <code>exactly</code>, <code>at_least</code> and
<code>at_most</code></p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_exactly'>exactly</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span>
<span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_least'>at_least</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span>
<span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_dealer'>dealer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:deal_card</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_at_most'>at_most</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245
246</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 243</span>

<span class='kw'>def</span> <span class='id identifier rubyid_times'>times</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="twice-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>twice</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Expect a message to be received exactly two times.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:go</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_twice'>twice</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


275
276
277
278
279</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 275</span>

<span class='kw'>def</span> <span class='id identifier rubyid_twice'>twice</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_set_expected_received_count'>set_expected_received_count</span> <span class='symbol'>:exactly</span><span class='comma'>,</span> <span class='int'>2</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>) <strong>with</strong>(*args, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Constrains a stub or message expectation to invocations with specific
arguments.</p>

<p>With a stub, if the message might be received with other args as well, you
should stub a default value first, and then stub or mock the same message
using <code>with</code> to constrain to specific arguments.</p>

<p>A message expectation will fail if the message is received with different
arguments.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:add</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='symbol'>:failure</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_allow'>allow</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:add</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1934356379</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='symbol'>:success</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1234567890</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># =&gt; :failure
</span><span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1934356379</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># =&gt; :success
</span>
<span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='symbol'>:add</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1934356379</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='symbol'>:success</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1234567890</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># =&gt; failed expectation
</span><span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'>Book</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:isbn</span> <span class='op'>=&gt;</span> <span class='int'>1934356379</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># =&gt; passes</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="RSpec::Mocks::MessageExpectation (class)">MessageExpectation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self, to support further chaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


319
320
321
322
323
324
325
326
327
328
329</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rspec/mocks/message_expectation.rb', line 319</span>

<span class='kw'>def</span> <span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise_already_invoked_error_if_necessary'>raise_already_invoked_error_if_necessary</span><span class='lparen'>(</span><span class='id identifier rubyid___method__'>__method__</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`with` must have at least one argument. Use `no_args` matcher to set the expectation of receiving no arguments.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inner_implementation_action'>inner_implementation_action</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='ivar'>@argument_list_matcher</span> <span class='op'>=</span> <span class='const'>ArgumentListMatcher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed Nov 11 23:57:52 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.5).
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59095215-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
